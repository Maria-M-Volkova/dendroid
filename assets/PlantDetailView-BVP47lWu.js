import{u as B,s as C,r as g,c as D,o as M,g as S,a as n,b as t,d as F,t as u,i as m,k as r,f as w,F as k,e as V,j as L,w as p,l as c,x as P,v as T,h as o}from"./index-DN-l6Uom.js";import{p as q}from"./plant-icon-DCag06KB.js";import{_ as R,B as $}from"./BottomNavLayout-CismZKiS.js";const j={class:"plant-detail"},A={class:"detail-header"},E={class:"plant-card"},h=["src"],z={class:"plant-info"},G={class:"description-section"},H={key:0},J={key:1,class:"no-description"},K={class:"tasks-section"},O={key:0,class:"no-tasks"},Q={class:"task-list"},W=["onClick"],X=["src"],Y={class:"title"},Z={class:"date"},ee={class:"date-row"},te=["value"],le={__name:"PlantDetailView",setup(se){const x=C(),f=S(),d=B(),v=parseInt(x.params.id,10),i=g({id:null,name:"",form:"seed",type:"pot",description:"",plantedDate:"",notes:"",image:""}),y=D(()=>d.icons);M(()=>{if(!isNaN(v)){const a=d.plants.find(e=>e.id===v);a?i.value={...a}:(console.warn("Растение не найдено"),f.push("/plants"))}});function _(a){const e=y.value.find(l=>l.name===a);return e?e.src:""}const b=D(()=>d.tasks.filter(a=>{var e;return(e=a.plantIds)==null?void 0:e.includes(v)})),s=g({id:null,title:"",description:"",startDate:"",dueDate:"",repeatable:!1,repeatType:"daily",icon:"watering",plantIds:[v]});function I(){s.value.title.trim()&&(s.value.id=Date.now(),d.addTask({...s.value}),s.value={id:null,title:"",description:"",startDate:"",dueDate:"",repeatable:!1,repeatType:"daily",icon:"watering",plantIds:[v]})}function N(a){f.push(`/tasks/edit/${a.id}`)}function U(){f.back()}return(a,e)=>(o(),n(k,null,[t("div",j,[t("header",A,[t("button",{class:"back-btn",onClick:U},"←"),t("h1",null,u(i.value.name),1)]),t("section",E,[t("img",{src:i.value.image||m(q),alt:"Растение",class:"plant-image"},null,8,h),t("div",z,[t("p",null,[e[7]||(e[7]=t("strong",null,"Форма:",-1)),r(" "+u(m(d).getFormLabel(i.value.form)),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"Тип посадки:",-1)),r(" "+u(m(d).getTypeLabel(i.value.type)),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"Дата посадки:",-1)),r(" "+u(m(d).formatDate(i.value.plantedDate)),1)])])]),t("section",G,[e[10]||(e[10]=t("h3",null,"Описание",-1)),i.value.description?(o(),n("p",H,u(i.value.description),1)):(o(),n("p",J,"Нет описания."))]),t("section",K,[e[17]||(e[17]=t("h3",null,"Задачи",-1)),b.value.length===0?(o(),n("div",O," Нет задач для данного растения. Добавьте новую задачу. ")):w("",!0),t("ul",Q,[(o(!0),n(k,null,V(b.value,l=>(o(),n("li",{key:l.id,class:"task-item",onClick:ae=>N(l)},[t("img",{src:_(l.icon),alt:"иконка",width:"20"},null,8,X),t("span",Y,u(l.title),1),t("small",Z,u(l.dueDate),1)],8,W))),128))]),t("form",{onSubmit:L(I,["prevent"]),class:"task-form"},[p(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.title=l),placeholder:"Название задачи",required:""},null,512),[[c,s.value.title]]),p(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.description=l),placeholder:"Описание задачи"},null,512),[[c,s.value.description]]),t("div",ee,[t("label",null,[e[11]||(e[11]=r("Начало: ")),p(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=l=>s.value.startDate=l),required:""},null,512),[[c,s.value.startDate]])]),t("label",null,[e[12]||(e[12]=r("Дедлайн: ")),p(t("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=l=>s.value.dueDate=l)},null,512),[[c,s.value.dueDate]])])]),t("label",null,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=l=>s.value.repeatable=l)},null,512),[[P,s.value.repeatable]]),e[13]||(e[13]=r(" Повторяется"))]),s.value.repeatable?p((o(),n("select",{key:0,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.repeatType=l)},e[14]||(e[14]=[t("option",{value:"daily"},"Ежедневно",-1),t("option",{value:"weekly"},"Еженедельно",-1),t("option",{value:"monthly"},"Ежемесячно",-1)]),512)),[[T,s.value.repeatType]]):w("",!0),t("label",null,[e[15]||(e[15]=r("Иконка: ")),p(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.icon=l)},[(o(!0),n(k,null,V(y.value,l=>(o(),n("option",{key:l.name,value:l.name},u(l.label),9,te))),128))],512),[[T,s.value.icon]])]),e[16]||(e[16]=t("button",{type:"submit",class:"btn-add-task"},"Добавить задачу",-1))],32)])]),F($)],64))}},ue=R(le,[["__scopeId","data-v-9096c764"]]);export{ue as default};
