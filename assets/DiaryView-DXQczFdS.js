import{a as c,h as u,b as t,t as b,j as Q,u as ee,c as M,r as m,d as R,m as te,f as j,w,l as L,v as z,p as ae,F as U,e as A,q as oe,s as ne,g as se,n as le,k as ie}from"./index-zC1LiGRU.js";import{_ as G,B as ue}from"./BottomNavLayout-I1hhDxtl.js";/* empty css                                                                        */const re={class:"modal-box"},de={__name:"DeleteTaskModal",props:{task:{type:Object,required:!0}},emits:["confirm","cancel"],setup($,{emit:x}){const D=x;function B(){D("confirm")}function y(){D("cancel")}return(V,v)=>(u(),c("div",{class:"modal-overlay",onClick:Q(y,["self"])},[t("div",re,[v[0]||(v[0]=t("h3",null,"Удалить задачу?",-1)),t("p",null,[t("strong",null,b($.task.title),1)]),v[1]||(v[1]=t("p",null,"Вы уверены, что хотите удалить эту задачу?",-1)),t("div",{class:"actions"},[t("button",{class:"btn btn-danger",onClick:B},"Удалить"),t("button",{class:"btn btn-cancel",onClick:y},"Отмена")])])]))}},ce=G(de,[["__scopeId","data-v-2d7a37e2"]]),De={class:"diary"},ve={class:"filters"},pe={key:0,class:"custom-dates"},fe=["value"],me={class:"upcoming-tasks"},ke={key:0,class:"no-tasks"},we={key:1,class:"task-list"},be=["onClick"],ye={class:"task-icon"},_e=["src"],ge={class:"task-info"},Ce={class:"task-title"},Te={class:"task-meta"},he={class:"task-date"},Se=["onClick"],xe={__name:"DiaryView",setup($){const x=se(),D=ee();new Date().setHours(0,0,0,0);const y=M(()=>D.tasks),V=M(()=>D.icons);function v(s){const e=V.value.find(l=>l.name===s);return e?e.src:""}const _=m(""),g=m("all"),C=m(""),T=m(""),h=m(""),N=M(()=>{const s=new Date;let e=[...y.value].map(o=>{const n=new Date(o.dueDate),i=Math.ceil((n-s)/(1e3*60*60*24));let d,Z=new Date(o.dueDate).toLocaleString("ru-RU",{dateStyle:"short"});return i<0?d=`Просрочено на ${Math.abs(i)} дн.`:i===0?d="Сегодня":i<=1?d="Завтра":i<=7?d=`${i} дн. осталось`:d=o.dueDate.toLocaleString("ru-RU",{dateStyle:"short"}),{...o,timeToDue:d,dateLocale:Z}});if(_.value.trim()){const o=_.value.toLowerCase();e=e.filter(n=>{var i;return(i=n.title)==null?void 0:i.toLowerCase().includes(o)})}const l=new Date;l.setHours(0,0,0,0),new Date(l).setDate(l.getDate()+1);const f=new Date(l);f.setDate(l.getDate()+1);const E=new Date(f);E.setDate(f.getDate()+1);const W=new Date(l);W.setHours(0,0,0,0);const F=new Date(l);F.setHours(23,59,59,0);const r=new Date(W);r.setDate(r.getDate()-(r.getDay()+6)%7);const H=new Date(r);H.setDate(r.getDate()+7);const S=new Date(r);S.setDate(r.getDate()-7);const q=new Date(S);q.setDate(S.getDate()+7);const k=new Date(r);k.setDate(k.getDate()+7);const I=new Date(k);switch(I.setDate(k.getDate()+7),g.value){case"today":e=e.filter(o=>{const n=new Date(o.dueDate);return n>=W&&n<=F});break;case"tomorrow":e=e.filter(o=>{const n=new Date(o.dueDate);return n>=f&&n<E});break;case"thisWeek":e=e.filter(o=>{const n=new Date(o.dueDate);return n>=r&&n<H});break;case"nextWeek":e=e.filter(o=>{const n=new Date(o.dueDate);return n>=k&&n<I});break;case"prevWeek":e=e.filter(o=>{const n=new Date(o.dueDate);return n>=S&&n<q});break;case"custom":if(T&&h){const o=new Date(T.value),n=new Date(h.value);e=e.filter(i=>{const d=new Date(i.dueDate);return d>=o&&d<=n})}break}return C.value&&(e=e.filter(o=>o.icon===C.value)),e.sort((o,n)=>new Date(o.dueDate)-new Date(n.dueDate)),e});function J(s){x.push(`/tasks/edit/${s.id}`)}function K(s){return new Date(s.dueDate)<new Date}function P(s){const e=Math.ceil((new Date(s.dueDate)-new Date)/864e5);return e<=3&&e>=0}const p=m(null);function X(s){p.value=s}function O(){p.value=null}function Y(){p.value&&(D.deleteTask(p.value.id),O())}return(s,e)=>{const l=ne("router-link");return u(),c(U,null,[t("div",De,[e[11]||(e[11]=t("h2",null,"Дневник задач",-1)),t("section",ve,[w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),placeholder:"Поиск по названию"},null,512),[[L,_.value]]),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a)},e[5]||(e[5]=[ae('<option value="all" data-v-f80bab25>Все дни</option><option value="today" data-v-f80bab25>Сегодня</option><option value="tomorrow" data-v-f80bab25>Завтра</option><option value="thisWeek" data-v-f80bab25>Эта неделя</option><option value="prevWeek" data-v-f80bab25>Прошлая неделя</option><option value="nextWeek" data-v-f80bab25>Следующая неделя</option><option value="custom" data-v-f80bab25>Указать даты вручную</option>',7)]),512),[[z,g.value]]),g.value==="custom"?(u(),c("div",pe,[e[6]||(e[6]=t("label",null,"С:",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>T.value=a)},null,512),[[L,T.value]]),e[7]||(e[7]=t("label",null,"По:",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=a=>h.value=a)},null,512),[[L,h.value]])])):j("",!0),w(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>C.value=a)},[e[8]||(e[8]=t("option",{value:""},"Все типы",-1)),(u(!0),c(U,null,A(V.value,a=>(u(),c("option",{key:a.name,value:a.name},b(a.label),9,fe))),128))],512),[[z,C.value]])]),t("section",me,[e[9]||(e[9]=t("h3",null,"Ближайшие задачи",-1)),N.value.length===0?(u(),c("div",ke,' Нет запланированных задач. Перейдите в раздел "Растения", чтобы добавить. ')):(u(),c("ul",we,[(u(!0),c(U,null,A(N.value,a=>(u(),c("li",{key:a.id,class:"task-card",onClick:f=>J(a)},[t("div",ye,[t("img",{src:v(a.icon),width:"20"},null,8,_e)]),t("div",ge,[t("div",Ce,b(a.title),1),t("div",Te,[t("span",{class:le(["time",{overdue:K(a),soon:P(a)}])},b(a.timeToDue),3),t("span",he,b(a.dateLocale),1)])]),t("button",{class:"delete-btn",onClick:Q(f=>X(a),["stop"]),title:"Удалить задачу"}," ❌ ",8,Se)],8,be))),128))]))]),p.value?(u(),te(ce,{key:0,task:p.value,onConfirm:Y,onCancel:O},null,8,["task"])):j("",!0),t("footer",null,[R(l,{to:"/plants",class:"btn-back"},{default:oe(()=>e[10]||(e[10]=[ie("Назад")])),_:1})])]),R(ue)],64)}}},Le=G(xe,[["__scopeId","data-v-f80bab25"]]);export{Le as default};
