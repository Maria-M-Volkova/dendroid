import{u as L,r as p,c as V,a as i,b as s,d as D,w as m,l as f,F as v,e as x,m as T,p as B,g as C,h as l,t as r,n as b,k as M}from"./index-B1HEurfJ.js";import{_ as N,B as U}from"./BottomNavLayout-BNkIRkT8.js";const $={class:"diary"},R={class:"filters"},F={class:"upcoming-tasks"},I={key:0,class:"no-tasks"},z={key:1,class:"task-list"},A=["onClick"],E={class:"task-icon"},H=["src"],O={class:"task-info"},Q={class:"task-title"},j={class:"task-meta"},q={class:"task-date"},G={__name:"DiaryView",setup(J){const h=C(),c=L(),d=p(""),u=p("");new Date().setHours(0,0,0,0);const _=V(()=>{const o=new Date;return[...c.tasks].filter(e=>e.dueDate).map(e=>{const a=new Date(e.dueDate),t=Math.ceil((a-o)/(1e3*60*60*24));let n,S=new Date(e.dueDate).toLocaleString("ru-RU",{dateStyle:"short"});return t<0?n=`Просрочено на ${Math.abs(t)} дн.`:t===0?n="Сегодня":t<=1?n="Завтра":t<=7?n=`${t} дн. осталось`:n=e.dueDate.toLocaleString("ru-RU",{dateStyle:"short"}),{...e,timeToDue:n,dateLocale:S}}).sort((e,a)=>new Date(e.dueDate)-new Date(a.dueDate))});function w(o){h.push(`/tasks/edit/${o.id}`)}function y(o){return new Date(o.dueDate)<new Date}function k(o){const e=Math.ceil((new Date(o.dueDate)-new Date)/864e5);return e<=3&&e>=0}function g(o){const e=c.icons.find(a=>a.name===o);return e?e.src:""}return(o,e)=>{const a=B("router-link");return l(),i(v,null,[s("div",$,[e[3]||(e[3]=s("h2",null,"Дневник задач",-1)),s("div",R,[m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),placeholder:"Поиск..."},null,512),[[f,d.value]]),m(s("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t)},null,512),[[f,u.value]])]),s("section",F,[_.value.length===0?(l(),i("div",I,' Нет запланированных задач. Перейдите в раздел "Растения", чтобы добавить. ')):(l(),i("ul",z,[(l(!0),i(v,null,x(_.value,t=>(l(),i("li",{key:t.id,class:"task-card",onClick:n=>w(t)},[s("div",E,[s("img",{src:g(t.icon),width:"20"},null,8,H)]),s("div",O,[s("div",Q,r(t.title),1),s("div",j,[s("span",{class:b(["time",{overdue:y(t),soon:k(t)}])},r(t.timeToDue),3),s("span",q,r(t.dateLocale),1)])])],8,A))),128))]))]),s("footer",null,[D(a,{to:"/plants",class:"btn-back"},{default:T(()=>e[2]||(e[2]=[M("Назад")])),_:1})])]),D(U)],64)}}},X=N(G,[["__scopeId","data-v-1ad9573c"]]);export{X as default};
